<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–≥–∞–¥–∞–π –±—Ä–µ–Ω–¥ –ø–æ —Å–ª–æ–≥–∞–Ω—É</title>
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100vh;
            background-color: #f4f4f4;
            overflow: hidden;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è */
        .fade-out {
            animation: fadeOut 0.7s ease forwards;
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .fade-in {
            animation: fadeIn 0.7s ease forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –º–∏–≥–∞–Ω–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ */
        @keyframes correctBlink {
            0% { border-color: green; }
            50% { border-color: transparent; }
            100% { border-color: green; }
        }

        .correct-border {
            animation: correctBlink 0.5s ease 4;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –º–∏–≥–∞–Ω–∏—è –¥–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ */
        @keyframes wrongBlink {
            0% { border-color: red; }
            50% { border-color: transparent; }
            100% { border-color: red; }
        }

        .wrong-border {
            animation: wrongBlink 0.5s ease 4;
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
		
		/* –°—Ç–∏–ª–∏ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É" –Ω–∞ iOS */		
		.ios-device #start-screen {
			flex-direction: column; /* –†–∞—Å–ø–æ–ª–∞–≥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ */
			justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
			align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
		}

		.ios-device #start-screen #start-btn {
			margin: 10px 0; /* –£–±–∏—Ä–∞–µ–º –±–æ–∫–æ–≤—ã–µ –æ—Ç—Å—Ç—É–ø—ã, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ */
		}

        @media (orientation: portrait) {
            .game-container {
                width: 100vw;
                height: calc(100vw * 16 / 9);
                max-width: none;
                max-height: 100vh;
            }

            #question-section {
                height: 15%;
                font-size: clamp(16px, 4vw, 24px);
                padding: 10px;
            }

            #progress-bar {
                height: 3px;
            }

            #answer-section {
                height: calc(85% - 3px);
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                padding: 10px;
            }

            .answer {
                padding: 5px;
            }

            .answer img {
                width: 95%;
                height: 95%;
                object-fit: contain;
            }
        }

        @media (orientation: landscape) {
            .game-container {
                width: calc(100vh * 16 / 9);
                height: 100vh;
            }

            #question-section {
                width: 100%;
                height: 15%;
                display: flex;
                justify-content: center;
                align-items: center;
                background-color: #DB3C30;
                color: white;
                overflow: hidden;
                padding: 10px;
                box-sizing: border-box;
            }

            #question {
                margin: 10px 15px;
                padding: 10px 15px;
                text-align: center;
                transition: font-size 0.0s ease;
                word-wrap: break-word;
            }

            #progress-bar {
                height: 3px;
            }

            #answer-section {
                height: calc(50% - 3px);
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
                padding: 20px;
            }

            .answer {
                padding: 5px;
            }

            .answer img {
                width: 95%;
                height: 95%;
                object-fit: contain;
            }
        }

        #question-section {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            background-color: #DB3C30;
            color: white;
        }

        #progress-bar {
            width: 100%;
            background-color: #444444;
            transform-origin: left;
            transform: scaleX(0);
            transition: transform 0.1s linear;
        }

        #answer-section {
            display: grid;
            gap: 10px;
            padding: 20px;
        }

        .answer {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f4f4f4;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s, opacity 0.3s;
            text-align: center;
        }

        .answer.correct {
            border-color: green;
        }

        .answer.wrong {
            border-color: red;
        }

        .answer.hide {
            opacity: 0;
            transform: scale(0);
        }

        .answer.disabled {
            pointer-events: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: #f44336;
            padding: 20px;
            text-align: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 30px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .modal-body {
            padding: 8px;
            text-align: center;
        }

        .modal-body p {
            font-size: 18px;
            color: #333;
            margin: 10px 0;
        }

        .modal-footer {
            padding: 8px;
            text-align: center;
        }

        .modal-footer button {
            margin: 5px;
            padding: 12px 24px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .modal-footer button:hover {
            background: #DB3C30;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
        }

        .modal-footer button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .modal-footer button:active {
            transform: translateY(0);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        #start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #start-screen button {
            margin: 10px;
            padding: 15px 30px;
            font-size: 20px;
            background-color: #DB3C30;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #start-screen button:hover {
            background-color: #cc0000;
        }

        .hidden {
            display: none !important;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –≤—ã–∏–≥—Ä—ã—à–µ–º */
        #win-modal .modal-content {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ */
        @media (orientation: landscape) {
            body.mobile-device #win-modal .modal-content {
                width: 60%;
                height: 80vh;
                max-width: none;
                border-radius: 20px;
            }

            body.mobile-device #win-modal .modal-header {
                padding: 10px;
            }

            body.mobile-device #win-modal .modal-body {
                max-height: 60vh;
                overflow-y: auto;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ü–ö –∏ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        body.desktop-device #win-modal .modal-content,
        body.mobile-device #win-modal .modal-content {
            /* –û—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }

        #win-modal .modal-header {
            background: #DB3C30;
            padding: 20px;
            text-align: center;
        }

        #win-modal .modal-header h2 {
            margin: 0;
            font-size: 30px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        #win-modal .modal-body {
            padding: 5px;
            text-align: center;
        }

        #win-modal .modal-body p {
            font-size: 18px;
            color: #333;
            margin: 10px 0;
        }

        #win-modal .modal-footer {
            padding: 20px;
            text-align: center;
        }

        #win-modal .modal-footer button {
            margin: 5px;
            padding: 12px 24px;
            background: #DB3C30;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        #win-modal .modal-footer button:hover {
            background: #cc0000;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
        }
		
		/* –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É "–ó–∞–∫—Ä—ã—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ "–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏" –¥–ª—è iOS */
		.ios-device #win-modal .modal-footer button {
			display: none;
		}

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" */
        #how-to-play-modal .modal-content {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out;
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ */
        @media (orientation: landscape) {
            body.mobile-device #how-to-play-modal .modal-content {
                width: 60%;
                height: 80vh;
                max-width: none;
                border-radius: 20px;
            }

            body.mobile-device #how-to-play-modal .modal-header {
                padding: 10px;
            }

            body.mobile-device #how-to-play-modal .modal-body {
                max-height: 60vh;
                overflow-y: auto;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ü–ö –∏ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        body.desktop-device #how-to-play-modal .modal-content,
        body.mobile-device #how-to-play-modal .modal-content {
            /* –û—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }

        #how-to-play-modal .modal-header {
            background: #DB3C30;
            padding: 20px;
            text-align: center;
        }

        #how-to-play-modal .modal-header h2 {
            margin: 0;
            font-size: 30px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        #how-to-play-modal .modal-body {
            padding: 20px 20px 5px 20px;
            text-align: left;
        }

        #how-to-play-modal .modal-body p {
            font-size: 18px;
            color: #333;
            margin: 10px 0;
        }

        #how-to-play-modal .modal-body ol {
            padding-left: 20px;
        }

        #how-to-play-modal .modal-body li {
            font-size: 16px;
            color: #333;
            margin: 10px 0;
        }

        #how-to-play-modal .modal-footer {
            padding: 5px 20px 20px 20px;
            text-align: center;
        }

        #how-to-play-modal .modal-footer button {
            margin: 5px;
            padding: 12px 24px;
            background: #DB3C30;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        #how-to-play-modal .modal-footer button:hover {
            background: #cc0000;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <!-- –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="start-screen">
        <button id="start-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        <button id="how-to-play-btn">–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</button>
    </div>

    <!-- –ò–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="game-container hidden">
        <div id="question-section">
            <h1 id="question"></h1>
        </div>
        <div id="progress-bar"></div>
        <div id="answer-section"></div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã</h2>
            </div>
            <div class="modal-body">
                <p id="modal-score">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <span class="highlight">0</span> –∏–∑ <span class="highlight">25</span></p>
                <p id="modal-high-score">üèÜ –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <span class="highlight">0</span></p>
                <p id="game-count-message">üéÆ –°—ã–≥—Ä–∞–Ω–æ –∏–≥—Ä: <span class="highlight">0</span> –∏–∑ 3000</p>
            </div>
            <div class="modal-footer">
                <button id="modal-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button id="modal-restart-btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–∏–≥—Ä—ã—à–∞ -->
    <div id="win-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!</h2>
            </div>
            <div class="modal-body">
                <!-- –¢–µ–∫—Å—Ç –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="modal-footer">
                <button id="win-modal-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" -->
    <div id="how-to-play-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h2>
            </div>
            <div class="modal-body">
                <p>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∏–≥—Ä–µ ¬´–£–≥–∞–¥–∞–π –±—Ä–µ–Ω–¥ –ø–æ —Å–ª–æ–≥–∞–Ω—É¬ª:</p>
                <ol>
                    <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–ù–∞—á–∞—Ç—å –∏–≥—Ä—É¬ª</li>
                    <li>–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Å–ª–æ–≥–∞–Ω –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –±—Ä–µ–Ω–¥ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</li>
                    <li>–£–¥–∞–ª—è–π—Ç–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Å–≤–∞–π–ø–∞—è –∏—Ö –≤ —Å—Ç–æ—Ä–æ–Ω—É –∏–ª–∏ –∫–ª–∏–∫–∞—è –ø–æ –Ω–∏–º</li>
                    <li>–ï—Å–ª–∏ –≤—Ä–µ–º—è –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç, –∏–≥—Ä–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É</li>
                    <li>–ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
                </ol>
                <p>–£ –≤–∞—Å 3 –ø–æ–ø—ã—Ç–∫–∏!</p>
            </div>
            <div class="modal-footer">
                <button id="how-to-play-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button id="how-to-play-start-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button> <!-- –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ -->
            </div>
        </div>
    </div>

    <!-- –ó–≤—É–∫–∏ -->
    <audio id="correct-sound" src="sounds/correct.mp3"></audio>
    <audio id="wrong-sound" src="sounds/wrong.mp3"></audio>
    <audio id="click-sound" src="sounds/click.mp3"></audio>

    <script>
		// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ
		const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent) && /Safari/.test(navigator.userAgent);
		const platform = isIOS ? 'iOS/Safari' : 'Chrome/Windows';

		console.log(`–ó–∞–ø—É—â–µ–Ω–æ –Ω–∞: ${platform}`);

		// –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
		const questionElement = document.getElementById('question');
		const answerSection = document.getElementById('answer-section');
		const startScreen = document.getElementById('start-screen');
		const startBtn = document.getElementById('start-btn');
		const gameContainer = document.querySelector('.game-container');
		const modal = document.getElementById('modal');
		const modalScore = document.getElementById('modal-score');
		const modalHighScore = document.getElementById('modal-high-score');
		const modalCloseBtn = document.getElementById('modal-close-btn');
		const modalRestartBtn = document.getElementById('modal-restart-btn');
		const gameCountMessage = document.getElementById('game-count-message');
		const winModal = document.getElementById('win-modal');
		const winModalCloseBtn = document.getElementById('win-modal-close-btn');

		// –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" –¥–ª—è iOS
		if (isIOS) {
			const howToPlayBtn = document.getElementById('how-to-play-btn');
			if (howToPlayBtn) {
				howToPlayBtn.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
			}
		}
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        function isMobileDevice() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            return /android/i.test(userAgent) || /iPad|iPhone|iPod/i.test(userAgent);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞
        function isLandscape() {
            return window.matchMedia("(orientation: landscape)").matches;
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –∫ <body> –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        if (isMobileDevice()) {
            document.body.classList.add('mobile-device');
        } else {
            document.body.classList.add('desktop-device');
        }
		if (isIOS) {
			document.body.classList.add('ios-device');
		}

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å"
        function updateHowToPlayModalText() {
            const howToPlayModalBody = document.querySelector('#how-to-play-modal .modal-body');
            const isMobile = isMobileDevice();
            const isLandscapeMode = isLandscape();

            if (isMobile && isLandscapeMode) {
                // –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
                howToPlayModalBody.innerHTML = `
                    <ol>
                        <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–ù–∞—á–∞—Ç—å –∏–≥—Ä—É¬ª</li>
                        <li>–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Å–ª–æ–≥–∞–Ω –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –±—Ä–µ–Ω–¥</li>
                        <li>–°–º–∞—Ö–Ω–∏—Ç–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å —ç–∫—Ä–∞–Ω–∞</li>
                        <li>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—Ä–µ–º–µ–Ω–µ–º, —É –≤–∞—Å 3 –ø–æ–ø—ã—Ç–∫–∏</li>
                    </ol>
                `;
            } else {
                // –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –ü–ö –∏ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
                howToPlayModalBody.innerHTML = `
                    <p>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∏–≥—Ä–µ ¬´–£–≥–∞–¥–∞–π –±—Ä–µ–Ω–¥ –ø–æ —Å–ª–æ–≥–∞–Ω—É¬ª:</p>
                    <ol>
                        <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–ù–∞—á–∞—Ç—å –∏–≥—Ä—É¬ª</li>
                        <li>–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Å–ª–æ–≥–∞–Ω –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –±—Ä–µ–Ω–¥ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</li>
                        <li>–£–¥–∞–ª—è–π—Ç–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Å–≤–∞–π–ø–∞—è –∏—Ö –≤ —Å—Ç–æ—Ä–æ–Ω—É –∏–ª–∏ –∫–ª–∏–∫–∞—è –ø–æ –Ω–∏–º</li>
                        <li>–ï—Å–ª–∏ –≤—Ä–µ–º—è –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç, –∏–≥—Ä–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É</li>
                        <li>–ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
                    </ol>
                    <p>–£ –≤–∞—Å 3 –ø–æ–ø—ã—Ç–∫–∏!</p>
                `;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ "–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!"
        function updateWinModalText() {
            const winModalBody = document.querySelector('#win-modal .modal-body');
            const isMobile = isMobileDevice();
            const isLandscapeMode = isLandscape();

            console.log("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ '–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!'"); // –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            console.log(`isMobile: ${isMobile}, isLandscapeMode: ${isLandscapeMode}`); // –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

            if (isMobile && isLandscapeMode) {
                // –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
                winModalBody.innerHTML = `
                    <p>–° —á–µ–º –≤–∞—Å –¥—É—à–µ–≤–Ω–æ –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º.</p>
                    <p>–í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 15% —Å–∫–∏–¥–∫—É –Ω–∞ –ª—é–±—ã–µ —É—Å–ª—É–≥–∏ –∫–æ–Ω—Ç–µ–Ω—Ç-–∞—Ç–µ–ª—å–µ –¢–ï–•–¢ASY.</p>
                    <p>–°–∫–∏–¥–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –ø—Ä–∏ –ø—Ä–µ–¥—ä—è–≤–ª–µ–Ω–∏–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ —ç—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π.</p>
                `;
            } else {
                // –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –ü–ö –∏ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
                winModalBody.innerHTML = `
                    <p>–° —á–µ–º –≤–∞—Å –¥—É—à–µ–≤–Ω–æ –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º.</p>
                    <p>–í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 15% —Å–∫–∏–¥–∫—É –Ω–∞ –ª—é–±—ã–µ —É—Å–ª—É–≥–∏ –∫–æ–Ω—Ç–µ–Ω—Ç-–∞—Ç–µ–ª—å–µ –¢–ï–•–¢ASY.</p>
                    <p>–°–∫–∏–¥–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –ø—Ä–∏ –ø—Ä–µ–¥—ä—è–≤–ª–µ–Ω–∏–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ —ç—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π.</p>
                    <p>–ü–æ—Ç–æ—Ä–æ–ø–∏—Ç–µ—Å—å!</p>
                    <p>–ò –Ω–µ –∑–∞–±—É–¥—å—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç.</p>
                `;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞
        window.addEventListener('resize', () => {
            if (howToPlayModal.style.display === 'flex') {
                updateHowToPlayModalText(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" –æ—Ç–∫—Ä—ã—Ç–æ
            }
            if (winModal.style.display === 'flex') {
                updateWinModalText(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!" –æ—Ç–∫—Ä—ã—Ç–æ
            }
        });

        // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM
        const howToPlayBtn = document.getElementById('how-to-play-btn');
        const howToPlayModal = document.getElementById('how-to-play-modal');
        const howToPlayCloseBtn = document.getElementById('how-to-play-close-btn');
        const howToPlayStartBtn = document.getElementById('how-to-play-start-btn'); // –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å"
        howToPlayBtn.addEventListener('click', () => {
            updateHowToPlayModalText(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º
            howToPlayModal.style.display = 'flex';
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" –ø–æ –∫–Ω–æ–ø–∫–µ
        howToPlayCloseBtn.addEventListener('click', () => {
            howToPlayModal.style.display = 'none';
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–π –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å"
        howToPlayStartBtn.addEventListener('click', async () => {
            isSoundUnlocked = true;
            await playSound('click');
            howToPlayModal.style.display = 'none'; // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            startScreen.classList.add('hidden');
            gameContainer.classList.remove('hidden');
            await startGame();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
        howToPlayModal.addEventListener('click', (e) => {
            if (e.target === howToPlayModal) {
                howToPlayModal.style.display = 'none';
            }
        });

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let timer;
        const timeLimit = 10;
        const maxGameCount = 3000;
        let gameCount = localStorage.getItem('gameCount') ? parseInt(localStorage.getItem('gameCount')) : 0;
        let isSoundUnlocked = false;
        let activeSounds = [];
        let isAnswerSelected = false;

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        function waitForImagesToLoad() {
            const images = document.querySelectorAll('.answer img');
            const promises = [];

            images.forEach(img => {
                if (!img.complete) {
                    const promise = new Promise((resolve) => {
                        img.addEventListener('load', resolve);
                        img.addEventListener('error', resolve);
                    });
                    promises.push(promise);
                }
            });

            return Promise.all(promises);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞
        function adjustFontSize() {
            const questionSection = document.getElementById('question-section');
            const maxFontSize = 34;
            const minFontSize = 16;
            let fontSize = maxFontSize;

            questionElement.style.fontSize = `${fontSize}px`;

            while (
                questionElement.scrollWidth > questionSection.offsetWidth ||
                questionElement.scrollHeight > questionSection.offsetHeight
            ) {
                fontSize -= 1;
                questionElement.style.fontSize = `${fontSize}px`;

                if (fontSize <= minFontSize) {
                    break;
                }
            }

            while (
                fontSize < maxFontSize &&
                questionElement.scrollWidth < questionSection.offsetWidth &&
                questionElement.scrollHeight < questionSection.offsetHeight
            ) {
                fontSize += 1;
                questionElement.style.fontSize = `${fontSize}px`;
            }
        }

        // –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('load', adjustFontSize);
        window.addEventListener('resize', adjustFontSize);

        // –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –≤–æ–ø—Ä–æ—Å–∞
        new MutationObserver(adjustFontSize).observe(questionElement, {
            childList: true,
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞
        function playSound(type) {
            return new Promise((resolve, reject) => {
                if (!isSoundUnlocked) {
                    console.log("–ó–≤—É–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞—á–∞–ª –∏–≥—Ä—É.");
                    resolve();
                    return;
                }

                let baseSound;
                let soundFolder;
                let soundFiles = [];

                switch (type) {
                    case 'correct':
                        baseSound = document.getElementById('correct-sound');
                        soundFolder = 'sounds/correct/';
                        soundFiles = ['correct1.mp3', 'correct2.mp3', 'correct3.mp3', 'correct4.mp3', 'correct5.mp3', 'correct6.mp3', 'correct7.mp3', 'correct8.mp3'];
                        break;
                    case 'wrong':
                        baseSound = document.getElementById('wrong-sound');
                        soundFolder = 'sounds/wrong/';
                        soundFiles = ['wrong1.mp3', 'wrong2.mp3', 'wrong3.mp3', 'wrong4.mp3', 'wrong5.mp3', 'wrong6.mp3', 'wrong7.mp3', 'wrong8.mp3', 'wrong9.mp3', 'wrong10.mp3', 'wrong11.mp3', 'wrong12.mp3', 'wrong13.mp3', 'wrong14.mp3', 'wrong15.mp3'];
                        break;
                    case 'click':
                        baseSound = document.getElementById('click-sound');
                        break;
                    case 'start':
                        soundFolder = 'sounds/start/';
                        soundFiles = ['start1.mp3', 'start2.mp3', 'start3.mp3', 'start4.mp3', 'start5.mp3'];
                        break;
                    case 'end':
                        soundFolder = 'sounds/end/';
                        soundFiles = ['end1.mp3', 'end2.mp3', 'end3.mp3', 'end4.mp3', 'end5.mp3', 'end6.mp3'];
                        break;
                    default:
                        resolve();
                        return;
                }

                if (baseSound) {
                    console.log(`–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∑–≤—É–∫–∞: ${type}`);
                    baseSound.currentTime = 0;
                    activeSounds.push(baseSound);

                    baseSound.play()
                        .then(() => {
                            baseSound.addEventListener('ended', () => {
                                activeSounds = activeSounds.filter(sound => sound !== baseSound);
                                console.log(`–ë–∞–∑–æ–≤—ã–π –∑–≤—É–∫ ${type} –∑–∞–≤–µ—Ä—à–µ–Ω.`);
                                resolve();
                            });
                        })
                        .catch(error => {
                            console.error("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞:", error);
                            resolve();
                        });
                } else {
                    resolve();
                }

                if (soundFolder && soundFiles.length > 0) {
                    const randomSoundFile = soundFiles[Math.floor(Math.random() * soundFiles.length)];
                    const randomSound = new Audio(soundFolder + randomSoundFile);

                    setTimeout(() => {
                        console.log(`–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–≤—É–∫–∞: ${type}`);
                        randomSound.currentTime = 0;
                        activeSounds.push(randomSound);

                        randomSound.play()
                            .then(() => {
                                randomSound.addEventListener('ended', () => {
                                    activeSounds = activeSounds.filter(sound => sound !== randomSound);
                                    console.log(`–°–ª—É—á–∞–π–Ω—ã–π –∑–≤—É–∫ ${type} –∑–∞–≤–µ—Ä—à–µ–Ω.`);
                                });
                            })
                            .catch(error => {
                                console.error("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–≤—É–∫–∞:", error);
                            });
                    }, baseSound ? baseSound.duration * 1000 : 0);
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–≤—É–∫–æ–≤
        async function waitForSounds() {
            while (activeSounds.length > 0) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã
        async function startGame() {
            console.log("–ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã...");
            if (gameCount >= maxGameCount) {
                alert("–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ –∏–≥—Ä (3 —Ä–∞–∑–∞).");
                return;
            }

            currentQuestions = getRandomQuestions(25);
            currentQuestionIndex = 0;
            score = 0;

            await playSound('start');
            showQuestion();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
        async function endGame() {
            gameCount++;
            localStorage.setItem('gameCount', gameCount);
            saveScore(score);

            await waitForSounds();
            await playSound('end');

            await waitForSounds();

            if (score >= 1) {
                showWinModal();
            } else {
                showModal();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –≤—ã–∏–≥—Ä—ã—à–µ
        function showWinModal() {
            updateWinModalText(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º
            winModal.style.display = 'flex'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –≤—ã–∏–≥—Ä—ã—à–µ–º
        winModalCloseBtn.addEventListener('click', () => {
            winModal.style.display = 'none';
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
        function getRandomQuestions(count) {
            const shuffledQuestions = shuffleArray([...allQuestions]);
            return shuffledQuestions.slice(0, count);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è showQuestion
        async function showQuestion() {
            console.log("–ü–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞...");

            if (currentQuestionIndex >= currentQuestions.length) {
                endGame();
                return;
            }

            resetTimer();

            const question = currentQuestions[currentQuestionIndex];
            const questionElement = document.getElementById('question');
            const answerSection = document.getElementById('answer-section');

            if (platform !== 'iOS/Safari') {
                questionElement.classList.add('fade-out');
                answerSection.classList.add('fade-out');
            }

            setTimeout(async () => {
                questionElement.innerText = question.question;
                answerSection.innerHTML = '';

                const shuffledAnswers = shuffleArray([...question.answers]);
                shuffledAnswers.forEach(answer => {
                    const button = document.createElement('div');
                    button.classList.add('answer');
                    button.innerHTML = `<img src="${answer.image}" alt="${answer.text}">`;

                    button.addEventListener('click', () => removeAnswer(button, answer));

                    if ('ontouchstart' in window) {
                        addSwipeListener(button, answer);
                    }

                    answerSection.appendChild(button);
                });

                await waitForImagesToLoad();

                if (platform !== 'iOS/Safari') {
                    questionElement.classList.remove('fade-out');
                    answerSection.classList.remove('fade-out');
                    questionElement.classList.add('fade-in');
                    answerSection.classList.add('fade-in');

                    setTimeout(() => {
                        questionElement.classList.remove('fade-in');
                        answerSection.classList.remove('fade-in');
                    }, 700);
                }

                startTimer();
            }, 700);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
        function removeAnswer(button, answer) {
            playSound('click');
            button.classList.add('hide');
            checkRemainingAnswers();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –æ—Ç–≤–µ—Ç–æ–≤
        async function checkRemainingAnswers() {
            if (isAnswerSelected) return;
            isAnswerSelected = true;

            const remainingAnswers = document.querySelectorAll('.answer:not(.hide)');
            if (remainingAnswers.length === 1) {
                const selectedAnswer = remainingAnswers[0];
                selectedAnswer.classList.add('disabled');

                const isCorrect = selectedAnswer.querySelector('img').alt === currentQuestions[currentQuestionIndex].answers.find(a => a.correct).text;

                if (isCorrect) {
                    score++;
                    selectedAnswer.classList.add('correct');
                    selectedAnswer.classList.add('correct-border');
                    await playSound('correct');
                } else {
                    selectedAnswer.classList.add('wrong');
                    selectedAnswer.classList.add('wrong-border');
                    await playSound('wrong');
                }

                clearInterval(timer);
                resetTimer();
				
				// –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—É–∑—É –¥–ª—è iOS
				if (isIOS) {
					await new Promise(resolve => setTimeout(resolve, 3000)); // –ü–∞—É–∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã
				}				

                if (currentQuestionIndex === currentQuestions.length - 1) {
                    endGame();
                } else {
                    currentQuestionIndex++;
                    await waitForSounds();
                    showQuestion();
                }
            }
            isAnswerSelected = false;
        }

		async function handleTimeOut() {
			if (isAnswerSelected) return;
			isAnswerSelected = true;

			await playSound('wrong');

			const remainingAnswers = document.querySelectorAll('.answer:not(.hide)');
			remainingAnswers.forEach(answer => {
				answer.classList.add('wrong');
				answer.classList.add('wrong-border');
				answer.classList.add('disabled');
			});

			// –ü–∞—É–∑–∞: 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, 3 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è iOS
			const pauseDuration = isIOS ? 3000 : 2000; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø–∞—É–∑—É –¥–ª—è iOS
			await new Promise(resolve => setTimeout(resolve, pauseDuration));

			clearInterval(timer);

			if (currentQuestionIndex === currentQuestions.length - 1) {
				await waitForSounds();
				endGame();
			} else {
				currentQuestionIndex++;
				await waitForSounds();
				showQuestion();
			}

			isAnswerSelected = false;
		}

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—á–µ—Ç–∞
        function saveScore(score) {
            const highScore = localStorage.getItem('brandGameHighScore') || 0;
            if (score > highScore) {
                localStorage.setItem('brandGameHighScore', score);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function showModal() {
            const modal = document.getElementById('modal');
            const modalContent = document.querySelector('.modal-content');
            const highScore = localStorage.getItem('brandGameHighScore') || 0;

            modalScore.innerText = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${score} –∏–∑ ${currentQuestions.length}`;
            modalHighScore.innerText = `–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${highScore}`;
            gameCountMessage.innerText = `–°—ã–≥—Ä–∞–Ω–æ –∏–≥—Ä: ${gameCount} –∏–∑ ${maxGameCount}`;

            if (gameCount >= maxGameCount) {
                modalRestartBtn.disabled = true;
                modalRestartBtn.innerText = "–õ–∏–º–∏—Ç –∏–≥—Ä –∏—Å—á–µ—Ä–ø–∞–Ω";
            }

            modal.style.display = 'flex';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeModal() {
            const modal = document.getElementById('modal');
            modal.style.display = 'none';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö –∑–≤—É–∫–æ–≤
        function stopAndClearAllSounds() {
            activeSounds.forEach(sound => {
                sound.pause();
                sound.currentTime = 0;
            });
            activeSounds = [];
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–∞
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ –∑–≤—É–∫–æ–≤
        function preloadSounds() {
            const soundUrls = [
                'sounds/correct.mp3',
                'sounds/wrong.mp3',
                'sounds/click.mp3',
                'sounds/correct/correct1.mp3',
                'sounds/correct/correct2.mp3',
                'sounds/correct/correct3.mp3',
                'sounds/correct/correct4.mp3',
                'sounds/correct/correct5.mp3',
                'sounds/correct/correct6.mp3',
                'sounds/correct/correct7.mp3',
                'sounds/correct/correct8.mp3',
                'sounds/wrong/wrong1.mp3',
                'sounds/wrong/wrong2.mp3',
                'sounds/wrong/wrong3.mp3',
                'sounds/wrong/wrong4.mp3',
                'sounds/wrong/wrong5.mp3',
                'sounds/wrong/wrong6.mp3',
                'sounds/wrong/wrong7.mp3',
                'sounds/wrong/wrong8.mp3',
                'sounds/wrong/wrong9.mp3',
                'sounds/wrong/wrong10.mp3',
                'sounds/wrong/wrong11.mp3',
                'sounds/wrong/wrong12.mp3',
                'sounds/wrong/wrong13.mp3',
                'sounds/wrong/wrong14.mp3',
                'sounds/wrong/wrong15.mp3',
                'sounds/start/start1.mp3',
                'sounds/start/start2.mp3',
                'sounds/start/start3.mp3',
                'sounds/start/start4.mp3',
                'sounds/start/start5.mp3',
                'sounds/end/end1.mp3',
                'sounds/end/end2.mp3',
                'sounds/end/end3.mp3',
                'sounds/end/end4.mp3',
                'sounds/end/end5.mp3',
                'sounds/end/end6.mp3'
            ];

            soundUrls.forEach(url => {
                const audio = new Audio(url);
                audio.preload = 'auto';
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–π
        function setupAnimations() {
            console.log("–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π –¥–ª—è Chrome/Windows");
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Ç–∞–π–º–µ—Ä–∞
        function resetTimer() {
            clearInterval(timer);
            const progressBar = document.getElementById('progress-bar');
            progressBar.style.transform = 'scaleX(0)';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            let timeLeft = timeLimit;
            const progressBar = document.getElementById('progress-bar');

            progressBar.style.transform = 'scaleX(1)';

            timer = setInterval(() => {
                timeLeft--;

                const progress = timeLeft / timeLimit;
                progressBar.style.transform = `scaleX(${progress})`;

                if (timeLeft <= 0) {
                    clearInterval(timer);
                    handleTimeOut();
                }
            }, 1000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–≤–∞–π–ø–∞
        function addSwipeListener(button, answer) {
            let startX = 0;
            let startY = 0;
            let isSwiped = false;

            button.addEventListener('touchstart', (e) => {
                const touch = e.touches[0];
                startX = touch.clientX;
                startY = touch.clientY;
                isSwiped = false;
            });

            button.addEventListener('touchmove', (e) => {
                if (isSwiped) return;

                const touch = e.touches[0];
                const deltaX = touch.clientX - startX;
                const deltaY = touch.clientY - startY;

                if (Math.abs(deltaX) > 50 || Math.abs(deltaY) > 50) {
                    isSwiped = true;

                    const direction = Math.abs(deltaX) > Math.abs(deltaY) ? (deltaX > 0 ? 'right' : 'left') : (deltaY > 0 ? 'down' : 'up');

                    button.style.transition = 'transform 0.3s, opacity 0.3s';
                    if (direction === 'left' || direction === 'right') {
                        button.style.transform = `translateX(${deltaX > 0 ? 100 : -100}%)`;
                    } else {
                        button.style.transform = `translateY(${deltaY > 0 ? 100 : -100}%)`;
                    }
                    button.style.opacity = '0';

                    setTimeout(() => {
                        removeAnswer(button, answer);
                    }, 300);
                }
            });

            button.addEventListener('touchend', (e) => {
                if (!isSwiped) {
                    const deltaX = e.changedTouches[0].clientX - startX;
                    const deltaY = e.changedTouches[0].clientY - startY;

                    const speedX = Math.abs(deltaX) / (e.timeStamp - startTime);
                    if (speedX < 0.5) {
                        button.style.transition = 'transform 0.2s, opacity 0.2s';
                        button.style.transform = 'translateX(0) translateY(0)';
                        button.style.opacity = '1';
                    } else {
                        isSwiped = true;
                        button.style.transition = 'transform 0.3s, opacity 0.3s';
                        button.style.transform = `translateX(${deltaX > 0 ? 100 : -100}%)`;
                        button.style.opacity = '0';
                        setTimeout(() => {
                            removeAnswer(button, answer);
                        }, 300);
                    }
                }
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è Chrome/Windows
        function initChromeWindows() {
            console.log("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è Chrome/Windows");

            preloadSounds();
            setupAnimations();

            startBtn.addEventListener('click', async () => {
                isSoundUnlocked = true;
                await playSound('click');
                startScreen.classList.add('hidden');
                gameContainer.classList.remove('hidden');
                await startGame();
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è iOS/Safari
        function initIOSSafari() {
            console.log("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è iOS/Safari");

            isSoundUnlocked = false;

            function setupSimplifiedAnimations() {
                console.log("–£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è iOS/Safari");
                document.querySelectorAll('.fade-in, .fade-out').forEach(element => {
                    element.style.animation = 'none';
                });
            }

            setupSimplifiedAnimations();
            startBtn.addEventListener('click', () => {
                startScreen.classList.add('hidden');
                gameContainer.classList.remove('hidden');
                startGame();
            });

            // –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
            const answers = document.querySelectorAll('.answer');
            answers.forEach(answer => {
                answer.removeEventListener('click', removeAnswer);
            });

            // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å–≤–∞–π–ø
            function addSwipeListener(button, answer) {
                let startX = 0;
                let startY = 0;
                let isSwiped = false;

                button.addEventListener('touchstart', (e) => {
                    const touch = e.touches[0];
                    startX = touch.clientX;
                    startY = touch.clientY;
                    isSwiped = false;
                });

                button.addEventListener('touchmove', (e) => {
                    if (isSwiped) return;

                    const touch = e.touches[0];
                    const deltaX = touch.clientX - startX;
                    const deltaY = touch.clientY - startY;

                    if (Math.abs(deltaX) > 50 || Math.abs(deltaY) > 50) {
                        isSwiped = true;

                        const direction = Math.abs(deltaX) > Math.abs(deltaY) ? (deltaX > 0 ? 'right' : 'left') : (deltaY > 0 ? 'down' : 'up');

                        button.style.transition = 'transform 0.3s, opacity 0.3s';
                        if (direction === 'left' || direction === 'right') {
                            button.style.transform = `translateX(${deltaX > 0 ? 100 : -100}%)`;
                        } else {
                            button.style.transform = `translateY(${deltaY > 0 ? 100 : -100}%)`;
                        }
                        button.style.opacity = '0';

                        setTimeout(() => {
                            removeAnswer(button, answer);
                        }, 300);
                    }
                });

                button.addEventListener('touchend', (e) => {
                    if (!isSwiped) {
                        const deltaX = e.changedTouches[0].clientX - startX;
                        const deltaY = e.changedTouches[0].clientY - startY;

                        const speedX = Math.abs(deltaX) / (e.timeStamp - startTime);
                        if (speedX < 0.5) {
                            button.style.transition = 'transform 0.2s, opacity 0.2s';
                            button.style.transform = 'translateX(0) translateY(0)';
                            button.style.opacity = '1';
                        } else {
                            isSwiped = true;
                            button.style.transition = 'transform 0.3s, opacity 0.3s';
                            button.style.transform = `translateX(${deltaX > 0 ? 100 : -100}%)`;
                            button.style.opacity = '0';
                            setTimeout(() => {
                                removeAnswer(button, answer);
                            }, 300);
                        }
                    }
                });
            }

            // –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–∞–π–ø –¥–ª—è –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤
            const answerButtons = document.querySelectorAll('.answer');
            answerButtons.forEach(button => {
                const answer = button.querySelector('img').alt;
                addSwipeListener(button, answer);
            });
        }

        // –í—ã–±–æ—Ä –≤–µ—Ç–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        if (platform === 'iOS/Safari') {
            initIOSSafari();
        } else {
            initChromeWindows();
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        modalCloseBtn.addEventListener('click', () => {
            stopAndClearAllSounds();
            closeModal();
        });

        modalRestartBtn.addEventListener('click', async () => {
            stopAndClearAllSounds();
            closeModal();
            await startGame();
        });

        // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
        const allQuestions = [
            {
                question: "–°–≤–µ–∂–µ–µ —Ä–µ—à–µ–Ω–∏–µ",
                answers: [
                    { text: "Mentos", correct: true, image: "images/mentos10.jpg" },
                    { text: "Orbit", correct: false, image: "images/orbit10.jpg" },
                    { text: "Dirol", correct: false, image: "images/dirol10.jpg" },
                    { text: "Wrigley's Spearmint", correct: false, image: "images/spearmint10.jpg" }
                ]
            },
            {
                question: "–¶–µ–Ω—ã –ø—Ä–æ—Å—Ç–æ –æ*—É–µ—Ç—å",
                answers: [
                    { text: "–ï–≤—Ä–æ—Å–µ—Ç—å", correct: true, image: "images/euroset.jpg" },
                    { text: "–ú.–í–∏–¥–µ–æ", correct: false, image: "images/mvideo.jpg" },
                    { text: "–≠–ª—å–¥–æ—Ä–∞–¥–æ", correct: false, image: "images/eldorado.jpg" },
                    { text: "Textasy", correct: false, image: "images/textasy.jpg" }
                ]
            }
            // –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –∑–¥–µ—Å—å
        ];
    </script>
</body>
</html>